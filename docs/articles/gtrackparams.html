<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of gTrack parameters • gTrack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of gTrack parameters">
<meta property="og:description" content="gTrack">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gTrack</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gtrackparams.html">Overview of gTrack parameters</a>
    </li>
    <li>
      <a href="../articles/quickstart.html">Creating and plotting gTracks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/mskilab/gTrack/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview of gTrack parameters</h1>
            
      
      <small class="dont-index">Source: <a href="http://github.com/mskilab/gTrack/blob/HEAD/../../../../groups/imielinski_lab/home/zchoo/git/gTrack/vignettes/gtrackparams.rmd" class="external-link"><code>../../../../groups/imielinski_lab/home/zchoo/git/gTrack/vignettes/gtrackparams.rmd</code></a></small>
      <div class="hidden name"><code>gtrackparams.rmd</code></div>

    </div>

    
    
<p>This is a (non-comprehensive) overview of <code>gTrack</code> parameters that are commonly modified from their default values.</p>
<div class="section level2">
<h2 id="axes-and-data">Axes and data<a class="anchor" aria-label="anchor" href="#axes-and-data"></a>
</h2>
<div class="section level3">
<h3 id="y-coordinates-y-field">Y-coordinates (y.field)<a class="anchor" aria-label="anchor" href="#y-coordinates-y-field"></a>
</h3>
<p>The x-coordinate of <code>gTrack</code> data is always a genomic interval. The y-coordinate can be either unspecified, or supplied in a metadata column of the <code>GRanges</code> or <code>GRangesList</code>. The name of this metadata column can be specified by supplying a character string to argument for <code>y.field</code>.</p>
<p>In the following example, we will plot two different metadata fields, one named <code>foreground</code> and one named <code>cn</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## read depth gTrack without name argument</span></span>
<span><span class="va">coverage.cn.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## read depth gTrack with name argument</span></span>
<span><span class="va">coverage.foreground.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"foreground"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.cn.gt</span>, <span class="va">coverage.foreground.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="track-names-name">Track names (name)<a class="anchor" aria-label="anchor" href="#track-names-name"></a>
</h3>
<p>The <code>name</code> specifies the track label that is shown to the right of a subplot. Arguments must be character vectors. The default behavior is to set <code>name</code> to an empty string if <code>y.field</code> is not specified, and otherwise to set <code>name</code> to the value passed to <code>y.field</code>. Below is an example of a scatter plot with and without a <code>name</code> argument.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## read depth gTrack without name argument</span></span>
<span><span class="va">coverage.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## read depth gTrack with name argument</span></span>
<span><span class="va">coverage.name.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, name <span class="op">=</span> <span class="st">"coverage"</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.gt</span>, <span class="va">coverage.name.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="displaying-or-hiding-the-y-axis-yaxis">Displaying or hiding the Y-axis (yaxis)<a class="anchor" aria-label="anchor" href="#displaying-or-hiding-the-y-axis-yaxis"></a>
</h3>
<p>The Y-axis of a <code>gTrack</code> can be toggled on or off entirely using the logical parameter <code>yaxis</code>, which has default value <code>TRUE</code> if <code>y.field</code> is specified and <code>FALSE</code> if not.</p>
<p>Here is an example where <code>yaxis</code> is deliberately set as <code>FALSE</code> despite suppling a value to <code>y.field</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## read depth gTrack</span></span>
<span><span class="va">coverage.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## read depth gTrack without Y-axis label</span></span>
<span><span class="va">coverage.noy.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span>, yaxis <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.gt</span>, <span class="va">coverage.noy.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="quantile-based-y-axis-cutoffs-y-quantile">Quantile-based Y-axis cutoffs (y.quantile)<a class="anchor" aria-label="anchor" href="#quantile-based-y-axis-cutoffs-y-quantile"></a>
</h3>
<p>By default, the minimum and maximum y-axis values are determined by the values of the 1st and 99th percentiles of the data to be plotted. This percentile can be changed by adjusting <code>y.quantile</code> in order to plot a wider or narrower range of points. The example below compares two different values of <code>y.quantile</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot points between 1st and 99th percentile</span></span>
<span><span class="va">coverage.1.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y.quantile <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot points between 20th and 80th percentile</span></span>
<span><span class="va">coverage.20.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y.quantile <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.1.gt</span>, <span class="va">coverage.20.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="specifying-y-axis-cutoffs-y0-and-y1">Specifying Y-axis cutoffs (y0 and y1)<a class="anchor" aria-label="anchor" href="#specifying-y-axis-cutoffs-y0-and-y1"></a>
</h3>
<p>The minimum and maximum y-axis values can also be specified directly with <code>y0</code> and <code>y1</code> respectively, which must be numeric values. Below is an example of the same data with two different settings for <code>y0</code> and <code>y1</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot points between 0 and 12</span></span>
<span><span class="va">coverage.wide.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot points between 5 and 10</span></span>
<span><span class="va">coverage.narrow.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">5</span>, y1 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.wide.gt</span>, <span class="va">coverage.narrow.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="unbounded-y-axes-y-cap">Unbounded Y-axes (y.cap)<a class="anchor" aria-label="anchor" href="#unbounded-y-axes-y-cap"></a>
</h3>
<p>Sometimes we may not want to specify limits on the y-coordinates at all, but rather ensure all points are plotted, regardless of how big or small they may be. This can be done by setting <code>y.cap = FALSE</code> as shown in the following example.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot points 1st and 99th percentiles (default)</span></span>
<span><span class="va">coverage.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## no limits on y</span></span>
<span><span class="va">coverage.all.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y.cap <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.gt</span>, <span class="va">coverage.all.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="point-density-and-spacing">Point density and spacing<a class="anchor" aria-label="anchor" href="#point-density-and-spacing"></a>
</h2>
<div class="section level3">
<h3 id="stacking-adjacent-ranges-stack-gap">Stacking adjacent ranges (stack.gap)<a class="anchor" aria-label="anchor" href="#stacking-adjacent-ranges-stack-gap"></a>
</h3>
<p>Sometimes closely spaced genomic intervals can be difficult to discern. If no y-coordinate is specified, sometimes it is helpful to stagger these intervals vertically to make them more visually distinct. This can be done by setting the parameter <code>stack.gap</code> to some numeric value. This will vertically stack adjacent intervals separated by a genomic distance (in base pairs) below that value.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create tiled genomic intervals</span></span>
<span><span class="va">win</span> <span class="op">=</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames <span class="op">=</span> <span class="st">"1"</span>, ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="op">(</span>start <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tiles</span> <span class="op">=</span> <span class="fu">gUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gUtils/man/gr.tile.html" class="external-link">gr.tile</a></span><span class="op">(</span><span class="va">win</span>, width <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## gTrack without vertical staggering</span></span>
<span><span class="va">tiles.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">tiles</span>, name <span class="op">=</span> <span class="st">"original"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## stack intervals within 1 Kbp of each other</span></span>
<span><span class="va">tiles.stack.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">tiles</span>, stack.gap <span class="op">=</span> <span class="fl">1000</span>, name <span class="op">=</span> <span class="st">"stacked"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">tiles.gt</span>, <span class="va">tiles.stack.gt</span><span class="op">)</span>, <span class="va">win</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="number-of-plotted-ranges-max-ranges">Number of plotted ranges (max.ranges)<a class="anchor" aria-label="anchor" href="#number-of-plotted-ranges-max-ranges"></a>
</h3>
<p>A <code>gTrack</code> with a huge number of genomic intervals can take a long time to plot, and if there are many overlapping points it doesn’t make sense to include all of them. To downsample points, you can set <code>max.ranges</code> to some number, which will only plot that number of randomly selected points.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot everything</span></span>
<span><span class="va">coverage.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, name <span class="op">=</span> <span class="st">"original"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## only plot 50 points</span></span>
<span><span class="va">coverage.downsample.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, max.ranges <span class="op">=</span> <span class="fl">50</span>, name <span class="op">=</span> <span class="st">"downsampled"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.gt</span>, <span class="va">coverage.downsample.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="data-labels">Data labels<a class="anchor" aria-label="anchor" href="#data-labels"></a>
</h2>
<p>By default, named <code>GRanges</code> and <code>GRangesList</code> are labeled in <code>gTrack</code>. This behavior is illustrated in the following example.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## define plotting window</span></span>
<span><span class="va">win</span> <span class="op">=</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames <span class="op">=</span> <span class="st">"1"</span>, ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="op">(</span>start <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create named GRanges</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames <span class="op">=</span> <span class="st">"1"</span>, ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50001</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1e3</span><span class="op">)</span>, strand <span class="op">=</span> <span class="st">"+"</span>, other_labels <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create gTrack</span></span>
<span><span class="va">gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">gr</span>, name <span class="op">=</span> <span class="st">"original"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span>, <span class="va">win</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="section level3">
<h3 id="suppressing-labels">Suppressing labels<a class="anchor" aria-label="anchor" href="#suppressing-labels"></a>
</h3>
<p>These labels can be hidden by setting <code>labels.suppress</code> to <code>TRUE</code>. If you want to specifically supress labels of a <code>GRanges</code> or <code>GRangesList</code>, you can also use <code>labels.suppress.gr</code> or <code>labels.suppress.grl</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create gTrack with no labels</span></span>
<span><span class="va">nolabels.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">gr</span>, labels.suppress <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"no labels"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">gt</span>, <span class="va">nolabels.gt</span><span class="op">)</span>, <span class="va">win</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="specifying-labels">Specifying labels<a class="anchor" aria-label="anchor" href="#specifying-labels"></a>
</h3>
<p>Labels can also be specified in a metadata column of a <code>GRanges</code> or <code>GRangesList</code>. To use these labels, the name of the relevant column should be passed as an argument for <code>gr.labelfield</code> or <code>grl.labelfield</code>, as seen in the example below. These will appear in the middle of the GRanges instead of on the left.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">otherlabels.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">gr</span>, gr.labelfield <span class="op">=</span> <span class="st">"other_labels"</span>, name <span class="op">=</span> <span class="st">"other labels"</span>, labels.suppress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">gt</span>, <span class="va">otherlabels.gt</span><span class="op">)</span>, <span class="va">win</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="point-and-line-style">Point and line style<a class="anchor" aria-label="anchor" href="#point-and-line-style"></a>
</h2>
<div class="section level3">
<h3 id="scatterplot-point-size-lwd-border">Scatterplot point size (lwd.border)<a class="anchor" aria-label="anchor" href="#scatterplot-point-size-lwd-border"></a>
</h3>
<p>The size of points in a scatterplot can be controlled by <code>lwd.border</code> with larger values producing larger points. Here is an illustrative example.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## two gTracks with slightly different point sizes</span></span>
<span><span class="va">coverage.small.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span>, name <span class="op">=</span> <span class="st">"small"</span><span class="op">)</span></span>
<span><span class="va">coverage.big.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.5</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span>, name <span class="op">=</span> <span class="st">"big"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.small.gt</span>, <span class="va">coverage.big.gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="width-of-plotted-ranges-ywid">Width of plotted ranges (ywid)<a class="anchor" aria-label="anchor" href="#width-of-plotted-ranges-ywid"></a>
</h3>
<p>The thickness of plotted segments can be adjusted using the <code>ywid</code> parameter.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">win</span> <span class="op">=</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames <span class="op">=</span> <span class="st">"1"</span>, ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="op">(</span>start <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create named GRanges</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames <span class="op">=</span> <span class="st">"1"</span>, ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50001</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span>, strand <span class="op">=</span> <span class="st">"+"</span>, cn <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, labs <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create gTrack</span></span>
<span><span class="va">narrow.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">gr</span>, name <span class="op">=</span> <span class="st">"narrow"</span>, ywid <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">wide.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">gr</span>, name <span class="op">=</span> <span class="st">"wide"</span>, ywid <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">narrow.gt</span>, <span class="va">wide.gt</span><span class="op">)</span>, <span class="va">win</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Alternatively, by adjusting the <code>ywid</code> metadata column of supplied <code>GRanges</code>, the width of each range can be adjusted individually.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">win</span> <span class="op">=</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames <span class="op">=</span> <span class="st">"1"</span>, ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="op">(</span>start <span class="op">=</span> <span class="fl">1</span>, width <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create named GRanges</span></span>
<span><span class="va">gr</span> <span class="op">=</span> <span class="fu">GRanges</span><span class="op">(</span>seqnames <span class="op">=</span> <span class="st">"1"</span>, ranges <span class="op">=</span> <span class="fu">IRanges</span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50001</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span>, strand <span class="op">=</span> <span class="st">"+"</span>, cn <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, labs <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, ywid <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create gTrack</span></span>
<span><span class="va">gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">gr</span>, name <span class="op">=</span> <span class="st">"narrow"</span>, gr.labelfield <span class="op">=</span> <span class="st">"labs"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">gt</span><span class="op">)</span>, <span class="va">win</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="colors">Colors<a class="anchor" aria-label="anchor" href="#colors"></a>
</h2>
<div class="section level3">
<h3 id="specifying-data-color-directly-col">Specifying data color directly (col)<a class="anchor" aria-label="anchor" href="#specifying-data-color-directly-col"></a>
</h3>
<p>If <code>col</code> is a metadata column of the <code>GRanges</code> or <code>GRangesList</code> used to construct a gTrack and contains colors (either in hexadecimal form or as character vectors) then these values determine the color of the plotted point. Here is an example, where points within 10 Kbp of a junction breakend are colored in red.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">values</span><span class="op">(</span><span class="va">coverage.gr</span><span class="op">)</span><span class="op">[</span>, <span class="st">"near_breakend"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">coverage.gr</span> <span class="op">%^%</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">gg</span><span class="op">$</span><span class="va">junctions</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="st">"ALT"</span><span class="op">]</span><span class="op">$</span><span class="va">grl</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1e4</span><span class="op">)</span>, <span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span></span>
<span><span class="fu">values</span><span class="op">(</span><span class="va">coverage.gr</span><span class="op">)</span><span class="op">[</span>, <span class="st">"col"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu">values</span><span class="op">(</span><span class="va">coverage.gr</span><span class="op">)</span><span class="op">[</span>, <span class="st">"near_breakend"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"yes"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coverage.col.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.col.gt</span>, <span class="va">gg</span><span class="op">$</span><span class="va">gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="coloring-by-secondary-label-gr-colorfield-and-grl-colorfield">Coloring by secondary label (gr.colorfield and grl.colorfield)<a class="anchor" aria-label="anchor" href="#coloring-by-secondary-label-gr-colorfield-and-grl-colorfield"></a>
</h3>
<p>We can also map discrete values in a metadata column in to colors automatically. Here is one example, using values in <code>near_breakend</code>. Here, <code>gr.colorfield</code> is set to <code>"near_breakend"</code> indicating that the <code>gTrack</code> should color points according to their value in this column. For <code>GRangesList</code> the analogous parameter <code>grl.colorfield</code> should be modified.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.col.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span>, gr.colorfield <span class="op">=</span> <span class="st">"near_breakend"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.col.gt</span>, <span class="va">gg</span><span class="op">$</span><span class="va">gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="custom-map-from-label-to-color-colormaps">Custom map from label to color (colormaps)<a class="anchor" aria-label="anchor" href="#custom-map-from-label-to-color-colormaps"></a>
</h3>
<p>When using <code>gr.colorfield</code> we can also supply a custom map of labels to colors by passing a named vector to <code>colormap</code>. Here is one illustrative example.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.col.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span>, gr.colorfield <span class="op">=</span> <span class="st">"near_breakend"</span>, colormap <span class="op">=</span> <span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="st">"yes"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"no"</span> <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.col.gt</span>, <span class="va">gg</span><span class="op">$</span><span class="va">gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="background-color-bg-col">Background color (bg.col)<a class="anchor" aria-label="anchor" href="#background-color-bg-col"></a>
</h3>
<p>We can change the background color of our gTrack using the <code>bg.col</code> param. Here is an example where the background is set to blue.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.col.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span>, col <span class="op">=</span> <span class="st">"black"</span>, bg.col <span class="op">=</span> <span class="fu"><a href="../reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.col.gt</span>, <span class="va">gg</span><span class="op">$</span><span class="va">gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="color-thresholds-cmap-max-and-cmap-min">Color thresholds (cmap.max and cmap.min)<a class="anchor" aria-label="anchor" href="#color-thresholds-cmap-max-and-cmap-min"></a>
</h3>
<p>When plotting <code>matrix</code> and <code>gMatrix</code> heatmaps it is sometimes useful to set thresholds for mapping numerical values to the color gradient. <code>cmap.min</code> is the minimum number, under which the gradient is not applied, and <code>cmap.max</code> is the maximum number to which the gradient is applied. Below, I plot two examples, with different ranges for these parameters.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.hic.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">gm</span><span class="op">$</span><span class="fu">gtrack</span><span class="op">(</span>cmap.min <span class="op">=</span> <span class="fl">0</span>, cmap.max <span class="op">=</span> <span class="fl">1000</span>, name <span class="op">=</span> <span class="st">"wide"</span><span class="op">)</span>, <span class="va">gm</span><span class="op">$</span><span class="fu">gtrack</span><span class="op">(</span>cmap.min <span class="op">=</span> <span class="fl">200</span>, cmap.max <span class="op">=</span> <span class="fl">300</span>, name <span class="op">=</span> <span class="st">"narrow"</span><span class="op">)</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="legends">Legends<a class="anchor" aria-label="anchor" href="#legends"></a>
</h2>
<p>In some of the examples above, you can see that when we use <code>gr.colorfield</code> or <code>grl.colorfield</code> a legend is created to show the mapping of labels to colors. Sometimes, we don’t want to include a legend in our <code>gTrack</code>. Omitting the legend is accomplished by setting the parameter <code>legend</code> to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.gr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">values</span><span class="op">(</span><span class="va">coverage.gr</span><span class="op">)</span><span class="op">[</span>, <span class="st">"near_breakend"</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">coverage.gr</span> <span class="op">%^%</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">gg</span><span class="op">$</span><span class="va">junctions</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="st">"ALT"</span><span class="op">]</span><span class="op">$</span><span class="va">grl</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1e4</span><span class="op">)</span>, <span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coverage.col.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.gr</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, y0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12</span>, gr.colorfield <span class="op">=</span> <span class="st">"near_breakend"</span><span class="op">)</span></span>
<span><span class="va">coverage.col.gt</span><span class="op">$</span><span class="va">legend</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span></span>
<span><span class="va">fp</span> <span class="op">=</span> <span class="fu">parse.gr</span><span class="op">(</span><span class="st">"1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.col.gt</span>, <span class="va">gg</span><span class="op">$</span><span class="va">gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="links">Links<a class="anchor" aria-label="anchor" href="#links"></a>
</h2>
<p>It is possible to plot aberrant adjacencies as a separate track. These must be supplied to the as a <code>GRangesList</code> to the <code>links</code> parameter of <code>plot</code>. The length of each constituent <code>GRanges</code> in this <code>GRangesList</code> should be 2.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## create GRangesList corresponding with ALT edges</span></span>
<span><span class="va">grl</span> <span class="op">=</span> <span class="va">gg</span><span class="op">$</span><span class="va">junctions</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="st">"ALT"</span><span class="op">]</span><span class="op">$</span><span class="va">grl</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">coverage.gt</span>, <span class="va">gg</span><span class="op">$</span><span class="va">gt</span><span class="op">)</span>, <span class="va">fp</span> <span class="op">+</span> <span class="fl">1e5</span>, links <span class="op">=</span> <span class="va">grl</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="sequence-names-with-chr-prefixes">Sequence names with chr prefixes<a class="anchor" aria-label="anchor" href="#sequence-names-with-chr-prefixes"></a>
</h2>
<p>Some genome assemblies (e.g. GrCh38) have sequence names with a <code>chr</code> prefix. By default, <code>gTrack</code> strips these prefixes, but sometimes it is preferable to keep them. This can be done by setting <code>chr.sub</code> to <code>FALSE</code> in both <code>plot</code> and <code>gTrack</code> instantiation. An example is below.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage.new</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.coverage.chr.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gg.new</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ovcar.subgraph.chr.rds"</span>, package <span class="op">=</span> <span class="st">"gTrack"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr.fp</span> <span class="op">=</span> <span class="fu">gUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gUtils/man/parse.gr.html" class="external-link">parse.gr</a></span><span class="op">(</span><span class="st">"chr1:6043576-7172800"</span><span class="op">)</span></span>
<span><span class="va">gg.gt</span> <span class="op">=</span> <span class="va">gg.new</span><span class="op">$</span><span class="fu">gtrack</span><span class="op">(</span>chr.sub <span class="op">=</span> <span class="cn">FALSE</span>, y.field <span class="op">=</span> <span class="st">"cn"</span><span class="op">)</span></span>
<span><span class="va">gg.gt</span><span class="op">$</span><span class="va">y.field</span> <span class="op">=</span> <span class="st">"cn"</span></span>
<span></span>
<span><span class="va">chr.coverage.gt</span> <span class="op">=</span> <span class="fu"><a href="../reference/gTrack-class.html">gTrack</a></span><span class="op">(</span><span class="va">coverage.new</span>, y.field <span class="op">=</span> <span class="st">"cn"</span>, circles <span class="op">=</span> <span class="cn">TRUE</span>, lwd.border <span class="op">=</span> <span class="fl">0.2</span>, chr.sub <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">grl</span> <span class="op">=</span> <span class="va">gg.new</span><span class="op">$</span><span class="va">junctions</span><span class="op">[</span><span class="va">type</span> <span class="op">==</span> <span class="st">"ALT"</span><span class="op">]</span><span class="op">$</span><span class="va">grl</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/c-methods.html">c</a></span><span class="op">(</span><span class="va">chr.coverage.gt</span>, <span class="va">gg.gt</span><span class="op">)</span>, <span class="va">chr.fp</span> <span class="op">+</span> <span class="fl">1e5</span>, links <span class="op">=</span> <span class="va">grl</span>, chr.sub <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="gtrackparams_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeremiah Wala, Marcin Imielinski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
